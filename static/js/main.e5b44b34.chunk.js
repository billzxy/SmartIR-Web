(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(t,e,n){var a={"./pano-20190724143458-mx.png":112,"./pano-20190724143833-mx.png":113,"./pano-20190724145944-mx.png":114,"./pano-20190724150711-mx.png":115,"./pano-20190724151238-mx.png":116,"./pano-20190724151553-mx.png":117,"./pano-demo.png":118,"./wall.jpg":119};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=111},112:function(t,e,n){t.exports=n.p+"static/media/pano-20190724143458-mx.072de3d6.png"},113:function(t,e,n){t.exports=n.p+"static/media/pano-20190724143833-mx.0732614b.png"},114:function(t,e,n){t.exports=n.p+"static/media/pano-20190724145944-mx.0c7531e1.png"},115:function(t,e,n){t.exports=n.p+"static/media/pano-20190724150711-mx.f67813cf.png"},116:function(t,e,n){t.exports=n.p+"static/media/pano-20190724151238-mx.3f9e7726.png"},117:function(t,e,n){t.exports=n.p+"static/media/pano-20190724151553-mx.c1e8bceb.png"},118:function(t,e,n){t.exports=n.p+"static/media/pano-demo.5890e08b.png"},119:function(t,e,n){t.exports=n.p+"static/media/wall.2b939dad.jpg"},122:function(t,e,n){},123:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(24),i=n.n(o),c=(n(71),n(26)),s=n(15),u=n(17),l=n(18);function d(){var t=Object(u.a)(["\n\tflex: 1;\n\tpadding: 24px;\n\tpadding-top: ","px;\n"]);return d=function(){return t},t}function p(){var t=Object(u.a)(["\n\tposition: fixed;\n\tz-index: 999;\n\ttop: 0;\n\tpadding: ","px;\n\theight: calc(","px - ","px * 2);\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tbackground-color: #f8f8f8;\n\twidth: 100%;\n\n\t& .ir-nav-item {\n\t\tmargin-right: 1rem;\n\t\ttext-decoration: none;\n\t\tcolor: rgba(0, 0, 0, 0.6);\n\t}\n\n\t& .ir-nav-item__active {\n\t\tcolor: #ea6c2f;\n\t}\n"]);return p=function(){return t},t}function h(){var t=Object(u.a)(["\n\twidth: 100vw;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n"]);return h=function(){return t},t}var f=l.a.div(h()),m=l.a.div(p(),12,64,12),g=l.a.div(d(),88),v=n(3),b=n.n(v),y=n(11),w=n(13),x=n(14),k=n(37),O=n(34),j=n(35),E=n(38),P=n(27);function L(t,e,n){if(!n)for(var a=0;a<t.length;a++){var r=[],o=!0,i=!1,c=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value;r.push(t[a][l])}}catch(b){i=!0,c=b}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}return r}for(a=0;a<t.length;a++)if(t[a].id===n){if(0===e.length)return t[a];var d={},p=!0,h=!1,f=void 0;try{for(var m,g=e[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var v=m.value;d[v]=t[a][v]}}catch(b){h=!0,f=b}finally{try{p||null==g.return||g.return()}finally{if(h)throw f}}return d}}var M={getPanoFileNameById:function(t){return Promise.resolve({data:{data:L(P,["filename"],t)}})},getPanoCoordById:function(t){return Promise.resolve({data:{data:L(P,["coord"],t)}})},getAllPanoIdAndCoord:function(){return Promise.resolve({data:{data:P}})},getPanoAllAttrById:function(t){return Promise.resolve({data:{data:L(P,[],t)}})}};function C(){var t=Object(u.a)(["\n\twidth: 100%;\n\theight: 100%;\n\n\t& > div {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n"]);return C=function(){return t},t}function A(){var t=Object(u.a)(["\n\twidth: 100% !important;\n\theight: 100% !important;\n\tposition: relative !important;\n"]);return A=function(){return t},t}var B=Object(l.a)(E.Map)(A()),N=l.a.div(C()),I=function(t){function e(t){var n;return Object(w.a)(this,e),(n=Object(k.a)(this,Object(O.a)(e).call(this,t))).bounds=new n.props.google.maps.LatLngBounds,n.state={showComp:!1},n}return Object(j.a)(e,t),Object(x.a)(e,[{key:"componentDidMount",value:function(){var t=this;(function(){var e=Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getAllPanoIdAndCoord().then(function(e){for(var n=[],a=e.data.data,r=0;r<a.length;r++)n.push({id:a[r].id,lat:a[r].coord.lat,lng:a[r].coord.lng});t.setState({coords:n,showComp:!0})});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()}},{key:"showComponent",value:function(t){!0!==t&&!1!==t||this.setState({showComp:t})}},{key:"setBounds",value:function(){for(var t=0;t<this.state.coords.length;t++){var e=this.state.coords[t];this.bounds.extend(new this.props.google.maps.LatLng({lat:e.lat,lng:e.lng}))}}},{key:"addMarkers",value:function(){var t=this;return this.setBounds(),this.state.coords.map(function(e,n){return r.a.createElement(E.Marker,{lid:e.id,position:{lat:e.lat,lng:e.lng},onClick:function(e){return t.showComponent(!1),t.gotoPano(e.lid)},key:e.id})})}},{key:"gotoPano",value:function(t){this.props.history.push("/viewPano/".concat(t))}},{key:"render",value:function(){return this.state.showComp?r.a.createElement(B,{ref:this.props.onMapMounted,google:this.props.google,zoom:18,initialCenter:{lat:42.36,lng:-71.054},bounds:this.bounds},this.addMarkers()):null}}]),e}(a.Component),D=Object(E.GoogleApiWrapper)({apiKey:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_GOOGLE_MAPS_API_KEY)})(Object(s.g)(I)),T=function(t){return r.a.createElement(N,null,r.a.createElement(D,t))},_=n(33),R=n(1),S=n(39),U=(n(62),n(89),n(47)),G=function(){function t(e){var n=this;Object(w.a)(this,t),this.coord={lat:0,lng:0},this.calibration=0,this.id=void 0,this.fname="",this.setAllAttr=Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.getPanoAllAttrById(n.id).then(function(t){n.fname=t.data.data.filename,n.coord.lat=t.data.data.coord.lat,n.coord.lng=t.data.data.coord.lng,n.calibration=t.data.data.calibration});case 2:case"end":return t.stop()}},t)})),this.updateCalibration=function(){var t=Object(y.a)(b.a.mark(function t(e){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:({calibration:-e.rotation.y}),alert("Update Calibration is disabled at this moment!");case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),this.id=e}return Object(x.a)(t,[{key:"getDistanceTo",value:function(t){return U.getDistance(this.coord,t.coord)}},{key:"getDistanceToNeighbors",value:function(t){return t.map(this.getDistanceTo)}},{key:"getBearingTo",value:function(t){return U.getRhumbLineBearing(this.coord,t.coord)}},{key:"getBearingToNeighbors",value:function(t){return t.map(this.getBearingTo)}}]),t}(),V=function(){function t(){Object(w.a)(this,t),this.mesh=void 0,this.material=void 0,this.geometry=void 0,this.id=void 0,this.geometry=new R.ConeBufferGeometry(1,1,16),this.material=new R.MeshBasicMaterial({color:"white"}),this.mesh=new R.Mesh(this.geometry,this.material)}return Object(x.a)(t,[{key:"onClickHandler",value:function(){}}]),t}(),Y=n(110),z=function(t){function e(t){var n;return Object(w.a)(this,e),(n=Object(k.a)(this,Object(O.a)(e).call(this,t))).currLoc=void 0,n.neighbors=void 0,n.cylindergeometry=new R.CylinderBufferGeometry(20,20,15,100,1,!0),n.cylindermaterial=void 0,n.cylindermesh=void 0,n.texture=void 0,n.loader=new R.TextureLoader,n.lines=[],n.state={isLoading:!0},n.RenderPano=n.RenderPano.bind(Object(_.a)(n)),n}return Object(j.a)(e,t),Object(x.a)(e,[{key:"componentDidMount",value:function(){var t=this;(function(){var e=Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.currLoc=new G(t.panoId),e.next=3,t.currLoc.setAllAttr().then(function(){t.loadTexture()});case 3:t.neighbors=new Map,t.setState({isLoading:!1});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()}},{key:"setNeighbors",value:function(){var t=Object(y.a)(b.a.mark(function t(){var e,n=this;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.neighbors.clear(),t.t0=this.currLoc.id,t.next="20190724143833"===t.t0?4:"20190724143458"===t.t0?6:8;break;case 4:return e=new G("20190724143458"),t.abrupt("break",8);case 6:return e=new G("20190724143833"),t.abrupt("break",8);case 8:return t.next=10,e.setAllAttr().then(function(){n.addNeighbor(e)});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"addNeighbor",value:function(t){this.neighbors.set(t.id,{location:t,distance:this.currLoc.getDistanceTo(t),bearing:this.currLoc.getBearingTo(t)})}},{key:"loadTexture",value:function(){this.texture=this.loader.load(n(111)("./".concat(this.currLoc.fname)),void 0,void 0,function(t){console.error(t)}),this.cylindermaterial=new R.MeshBasicMaterial({map:this.texture,side:R.DoubleSide}),this.cylindermesh=new R.Mesh(this.cylindergeometry,this.cylindermaterial),this.cylindergeometry.scale(-1,1,1),this.cylindermesh.rotation.y=this.currLoc.calibration}},{key:"InitNeighborPins",value:function(){var t=this;console.log(this.lines),0!==this.lines.length&&(this.lines=[]),this.neighbors.forEach(function(e,n){var a=e.bearing,r=new R.LineBasicMaterial({color:"blue"}),o=new R.Geometry;o.vertices.push(new R.Vector3(0,-5,0)),o.vertices.push(new R.Vector3(20*Math.sin(a*Math.PI/180),-5,-20*Math.cos(a*Math.PI/180))),t.lines.push(new R.Line(o,r))})}},{key:"CameraLookNorth",value:function(t){var e={at:t.rotation.y},n=new Y.Tween(e).to({at:0},750).easing(Y.Easing.Quadratic.InOut);n.onUpdate(function(){t.rotation.y=e.at}),n.onComplete(function(){t.rotation.y=0}),n.start()}},{key:"RenderPano",value:function(){var t=this,e=Object(a.useRef)(),n=Object(S.c)(),o=n.gl,i=n.camera,c=n.canvas,s=n.scene;i.fov=40,o.setSize(window.innerWidth,window.innerHeight),i.position.set(0,0,0),i.lookAt(0,0,0);var u=!1,l=0;function d(t){if(u){t.preventDefault();var e=t.clientX-l;t.clientY;l=t.clientX,t.clientY,function(t){i.rotation.y+=t/1e3,i.rotation.y%=2*Math.PI}(e)}}c.addEventListener("mousemove",function(t){return d(t)},!1),c.addEventListener("mousedown",function(t){return(e=t).preventDefault(),u=!0,l=e.clientX,void e.clientY;var e},!1),c.addEventListener("mouseup",function(t){return t.preventDefault(),void(u=!1)},!1);s.add(this.cylindermesh);var p=Object(a.useRef)();var h=new V,f=Object(a.useRef)(),m=Object(a.useRef)();return Object(S.b)(function(){Y.update(),m.current.position.set(-13*Math.sin(i.rotation.y),-2,-13*Math.cos(i.rotation.y)),p.current.position.set(-13*Math.sin(i.rotation.y),4,-13*Math.cos(i.rotation.y))}),r.a.createElement(r.a.Fragment,null,r.a.createElement("perspectiveCamera",{ref:e,fov:45,aspect:window.innerWidth/window.innerHeight,onUpdate:function(t){return t.updateProjectionMatrix()}}),r.a.createElement("group",{ref:m},r.a.createElement("mesh",{onClick:function(){t.CameraLookNorth(i)},ref:f,geometry:h.geometry},r.a.createElement("meshBasicMaterial",{attach:"material",color:"white"}))),r.a.createElement("group",{onClick:function(){return t.CameraLookNorth(i)},ref:p}))}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement("div",null,r.a.createElement("h3",null,"Loading...")):r.a.createElement("div",{className:"Pano-canvas"},r.a.createElement(S.a,null,r.a.createElement(this.RenderPano,null)))}},{key:"panoId",get:function(){return this.props.match.params.id||"20190724151553"}}]),e}(a.Component),F=Object(s.g)(z),H=(n(122),[{path:"/maps",title:"Pano Maps"},{path:"/viewPano",title:"View Pano"}]);i.a.render(r.a.createElement(function(){return r.a.createElement(c.a,null,r.a.createElement(f,null,r.a.createElement(m,null,H.map(function(t){return r.a.createElement(c.b,{to:t.path,key:t.path,activeClassName:"ir-nav-item__active",className:"ir-nav-item"},t.title)})),r.a.createElement(g,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/maps",component:T}),r.a.createElement(s.b,{exact:!0,path:"/viewPano/:id",component:F}),r.a.createElement(s.b,{path:"/viewPano",component:F}),r.a.createElement(s.a,{exact:!0,from:"/",to:"maps"})))))},null),document.getElementById("interface"))},27:function(t){t.exports=[{id:"20190724143458",filename:"pano-20190724143458-mx.png",coord:{lat:42.36000896,lng:-71.05425626},calibration:2.1959999999999638},{id:"20190724143833",filename:"pano-20190724143833-mx.png",coord:{lat:42.36000888,lng:-71.05416259},calibration:2.6039999999999637},{id:"20190724145944",filename:"pano-20190724145944-mx.png",coord:{lat:42.36014171,lng:-71.0525956},calibration:-2.368000000000113},{id:"20190724151238",filename:"pano-20190724151238-mx.png",coord:{lat:42.35946,lng:-71.05190878},calibration:-2.872000000000005},{id:"20190724151553",filename:"pano-20190724151553-mx.png",coord:{lat:42.35901057,lng:-71.05173236},calibration:-.5760000000000074},{id:"20190724150711",filename:"pano-20190724150711-mx.png",coord:{lat:42.35976055,lng:-71.05235965},calibration:-1.352814692820381}]},67:function(t,e,n){t.exports=n(123)},71:function(t,e,n){},89:function(t,e,n){}},[[67,1,2]]]);
//# sourceMappingURL=main.e5b44b34.chunk.js.map