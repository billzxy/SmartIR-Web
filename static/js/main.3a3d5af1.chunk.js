(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(t,n,e){var a={"./pano-20190724143458-mx.png":112,"./pano-20190724143833-mx.png":113,"./pano-20190724145944-mx.png":114,"./pano-20190724150711-mx.png":115,"./pano-20190724151238-mx.png":116,"./pano-20190724151553-mx.png":117,"./pano-demo.png":118,"./wall.jpg":119};function r(t){var n=o(t);return e(n)}function o(t){if(!e.o(a,t)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=111},112:function(t,n,e){t.exports=e.p+"static/media/pano-20190724143458-mx.072de3d6.png"},113:function(t,n,e){t.exports=e.p+"static/media/pano-20190724143833-mx.0732614b.png"},114:function(t,n,e){t.exports=e.p+"static/media/pano-20190724145944-mx.0c7531e1.png"},115:function(t,n,e){t.exports=e.p+"static/media/pano-20190724150711-mx.f67813cf.png"},116:function(t,n,e){t.exports=e.p+"static/media/pano-20190724151238-mx.3f9e7726.png"},117:function(t,n,e){t.exports=e.p+"static/media/pano-20190724151553-mx.c1e8bceb.png"},118:function(t,n,e){t.exports=e.p+"static/media/pano-demo.5890e08b.png"},119:function(t,n,e){t.exports=e.p+"static/media/wall.2b939dad.jpg"},122:function(t,n,e){},123:function(t,n,e){"use strict";e.r(n);var a=e(0),r=e.n(a),o=e(24),i=e.n(o),c=(e(71),e(26)),s=e(17),u=e(15),l=e(16);function d(){var t=Object(u.a)(["\n\tflex: 1;\n\tpadding: 24px;\n\tpadding-top: ","px;\n"]);return d=function(){return t},t}function f(){var t=Object(u.a)(["\n\tposition: fixed;\n\tz-index: 999;\n\ttop: 0;\n\tpadding: ","px;\n\theight: calc(","px - ","px * 2);\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tbackground-color: #f8f8f8;\n\twidth: 100%;\n\n\t& .ir-nav-item {\n\t\tmargin-right: 1rem;\n\t\ttext-decoration: none;\n\t\tcolor: rgba(0, 0, 0, 0.6);\n\t}\n\n\t& .ir-nav-item__active {\n\t\tcolor: #ea6c2f;\n\t}\n"]);return f=function(){return t},t}function p(){var t=Object(u.a)(["\n\twidth: 100vw;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n"]);return p=function(){return t},t}var h=l.a.div(p()),m=l.a.div(f(),12,64,12),g=l.a.div(d(),88),v=e(3),b=e.n(v),y=e(11),w=e(13),x=e(14),k=e(37),j=e(34),O=e(35),E=e(38),M=e(27);function P(t,n,e){if(!e)for(var a=0;a<t.length;a++){var r=[],o=!0,i=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value;r.push(t[a][l])}}catch(b){i=!0,c=b}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}return r}for(a=0;a<t.length;a++)if(t[a].id===e){if(0===n.length)return t[a];var d={},f=!0,p=!1,h=void 0;try{for(var m,g=n[Symbol.iterator]();!(f=(m=g.next()).done);f=!0){var v=m.value;d[v]=t[a][v]}}catch(b){p=!0,h=b}finally{try{f||null==g.return||g.return()}finally{if(p)throw h}}return d}}var C={getPanoFileNameById:function(t){return Promise.resolve({data:{data:P(M,["filename"],t)}})},getPanoCoordById:function(t){return Promise.resolve({data:{data:P(M,["coord"],t)}})},getAllPanoIdAndCoord:function(){return Promise.resolve({data:{data:M}})},getPanoAllAttrById:function(t){return Promise.resolve({data:{data:P(M,[],t)}})}};function L(){var t=Object(u.a)(["\n\twidth: 100%;\n\theight: 100%;\n\n\t& > div {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n"]);return L=function(){return t},t}function B(){var t=Object(u.a)(["\n\twidth: 100% !important;\n\theight: 100% !important;\n\tposition: relative !important;\n"]);return B=function(){return t},t}var A=Object(l.a)(E.Map)(B()),N=l.a.div(L()),I=function(t){function n(t){var e;return Object(w.a)(this,n),(e=Object(k.a)(this,Object(j.a)(n).call(this,t))).bounds=new e.props.google.maps.LatLngBounds,e.state={showComp:!1},e}return Object(O.a)(n,t),Object(x.a)(n,[{key:"componentDidMount",value:function(){var t=this;(function(){var n=Object(y.a)(b.a.mark(function n(){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,C.getAllPanoIdAndCoord().then(function(n){for(var e=[],a=n.data.data,r=0;r<a.length;r++)e.push({id:a[r].id,lat:a[r].coord.lat,lng:a[r].coord.lng});t.setState({coords:e,showComp:!0})});case 2:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}})()()}},{key:"showComponent",value:function(t){!0!==t&&!1!==t||this.setState({showComp:t})}},{key:"setBounds",value:function(){for(var t=0;t<this.state.coords.length;t++){var n=this.state.coords[t];this.bounds.extend(new this.props.google.maps.LatLng({lat:n.lat,lng:n.lng}))}}},{key:"addMarkers",value:function(){var t=this;return this.setBounds(),this.state.coords.map(function(n,e){return r.a.createElement(E.Marker,{lid:n.id,position:{lat:n.lat,lng:n.lng},onClick:function(n){return t.showComponent(!1),t.gotoPano(n.lid)},key:n.id})})}},{key:"gotoPano",value:function(t){this.props.history.push("/viewPano/".concat(t))}},{key:"render",value:function(){return this.state.showComp?r.a.createElement(A,{ref:this.props.onMapMounted,google:this.props.google,zoom:18,initialCenter:{lat:42.36,lng:-71.054},bounds:this.bounds},this.addMarkers()):null}}]),n}(a.Component),D=Object(E.GoogleApiWrapper)({apiKey:"".concat("AIzaSyAwmnfBgRgSFnydLrrkAJ2gYBfarvA7Fu4")})(Object(s.g)(I)),T=function(t){return r.a.createElement(N,null,r.a.createElement(D,t))},R=e(33),S=e(1),_=e(39),z=(e(62),e(89),e(47)),F=function(){function t(n){var e=this;Object(w.a)(this,t),this.coord={lat:0,lng:0},this.calibration=0,this.id=void 0,this.fname="",this.setAllAttr=Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.getPanoAllAttrById(e.id).then(function(t){e.fname=t.data.data.filename,e.coord.lat=t.data.data.coord.lat,e.coord.lng=t.data.data.coord.lng,e.calibration=t.data.data.calibration});case 2:case"end":return t.stop()}},t)})),this.updateCalibration=function(){var t=Object(y.a)(b.a.mark(function t(n){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:({calibration:-n.rotation.y}),alert("Update Calibration is disabled at this moment!");case 2:case"end":return t.stop()}},t)}));return function(n){return t.apply(this,arguments)}}(),this.id=n}return Object(x.a)(t,[{key:"getDistanceTo",value:function(t){return z.getDistance(this.coord,t.coord)}},{key:"getDistanceToNeighbors",value:function(t){return t.map(this.getDistanceTo)}},{key:"getBearingTo",value:function(t){return z.getRhumbLineBearing(this.coord,t.coord)}},{key:"getBearingToNeighbors",value:function(t){return t.map(this.getBearingTo)}}]),t}(),U=function(){function t(){Object(w.a)(this,t),this.mesh=void 0,this.material=void 0,this.geometry=void 0,this.id=void 0,this.geometry=new S.ConeBufferGeometry(1,1,16),this.material=new S.MeshBasicMaterial({color:"white"}),this.mesh=new S.Mesh(this.geometry,this.material)}return Object(x.a)(t,[{key:"onClickHandler",value:function(){}}]),t}();function G(){var t=Object(u.a)(["\n\t&,\n\t&:after {\n\t\tborder-radius: 50%;\n\t\twidth: ","px;\n\t\theight: ","px;\n\t}\n\t& {\n\t\tmargin: 60px auto;\n\t\tfont-size: 10px;\n\t\tposition: relative;\n\t\ttext-indent: -9999em;\n\t\tborder-top: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-right: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-bottom: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-left: 1.1em solid ",";\n\t\t-webkit-transform: translateZ(0);\n\t\t-ms-transform: translateZ(0);\n\t\ttransform: translateZ(0);\n\t\t-webkit-animation: load8 1.1s infinite linear;\n\t\tanimation: load8 1.1s infinite linear;\n\t}\n\t@-webkit-keyframes load8 {\n\t\t0% {\n\t\t\t-webkit-transform: rotate(0deg);\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\t100% {\n\t\t\t-webkit-transform: rotate(360deg);\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n\t@keyframes load8 {\n\t\t0% {\n\t\t\t-webkit-transform: rotate(0deg);\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\t100% {\n\t\t\t-webkit-transform: rotate(360deg);\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n"]);return G=function(){return t},t}var Y=l.a.div(G(),function(t){var n=t.width;return void 0===n?"48":n},function(t){var n=t.width;return void 0===n?"48":n},function(t){var n=t.color;return void 0===n?"#ea6c2f":n}),H=e(110),J=function(t){function n(t){var e;return Object(w.a)(this,n),(e=Object(k.a)(this,Object(j.a)(n).call(this,t))).currLoc=void 0,e.neighbors=void 0,e.cylindergeometry=new S.CylinderBufferGeometry(20,20,15,100,1,!0),e.cylindermaterial=void 0,e.cylindermesh=void 0,e.texture=void 0,e.loader=new S.TextureLoader,e.lines=[],e.state={isLoading:!0},e.RenderPano=e.RenderPano.bind(Object(R.a)(e)),e}return Object(O.a)(n,t),Object(x.a)(n,[{key:"componentDidMount",value:function(){var t=this;(function(){var n=Object(y.a)(b.a.mark(function n(){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.currLoc=new F(t.panoId),n.next=3,t.currLoc.setAllAttr().then(function(){t.loadTexture()});case 3:t.neighbors=new Map;case 4:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}})()()}},{key:"setNeighbors",value:function(){var t=Object(y.a)(b.a.mark(function t(){var n,e=this;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.neighbors.clear(),t.t0=this.currLoc.id,t.next="20190724143833"===t.t0?4:"20190724143458"===t.t0?6:8;break;case 4:return n=new F("20190724143458"),t.abrupt("break",8);case 6:return n=new F("20190724143833"),t.abrupt("break",8);case 8:return t.next=10,n.setAllAttr().then(function(){e.addNeighbor(n)});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"addNeighbor",value:function(t){this.neighbors.set(t.id,{location:t,distance:this.currLoc.getDistanceTo(t),bearing:this.currLoc.getBearingTo(t)})}},{key:"loadTexture",value:function(){var t=this;this.texture=this.loader.load(e(111)("./".concat(this.currLoc.fname)),function(){t.setState({isLoading:!1})},void 0,function(t){console.error(t)}),this.cylindermaterial=new S.MeshBasicMaterial({map:this.texture,side:S.DoubleSide}),this.cylindermesh=new S.Mesh(this.cylindergeometry,this.cylindermaterial),this.cylindergeometry.scale(-1,1,1),this.cylindermesh.rotation.y=this.currLoc.calibration}},{key:"InitNeighborPins",value:function(){var t=this;console.log(this.lines),0!==this.lines.length&&(this.lines=[]),this.neighbors.forEach(function(n,e){var a=n.bearing,r=new S.LineBasicMaterial({color:"blue"}),o=new S.Geometry;o.vertices.push(new S.Vector3(0,-5,0)),o.vertices.push(new S.Vector3(20*Math.sin(a*Math.PI/180),-5,-20*Math.cos(a*Math.PI/180))),t.lines.push(new S.Line(o,r))})}},{key:"CameraLookNorth",value:function(t){var n={at:t.rotation.y},e=new H.Tween(n).to({at:0},750).easing(H.Easing.Quadratic.InOut);e.onUpdate(function(){t.rotation.y=n.at}),e.onComplete(function(){t.rotation.y=0}),e.start()}},{key:"RenderPano",value:function(){var t=this,n=Object(a.useRef)(),e=Object(_.c)(),o=e.gl,i=e.camera,c=e.canvas,s=e.scene;i.fov=40,o.setSize(window.innerWidth,window.innerHeight),i.position.set(0,0,0),i.lookAt(0,0,0);var u=!1,l=0;function d(t){if(u){t.preventDefault();var n=t.clientX-l;t.clientY;l=t.clientX,t.clientY,function(t){i.rotation.y+=t/1e3,i.rotation.y%=2*Math.PI}(n)}}c.addEventListener("mousemove",function(t){return d(t)},!1),c.addEventListener("mousedown",function(t){return(n=t).preventDefault(),u=!0,l=n.clientX,void n.clientY;var n},!1),c.addEventListener("mouseup",function(t){return t.preventDefault(),void(u=!1)},!1);s.add(this.cylindermesh);var f=Object(a.useRef)();var p=new U,h=Object(a.useRef)(),m=Object(a.useRef)();return Object(_.b)(function(){H.update(),m.current.position.set(-13*Math.sin(i.rotation.y),-2,-13*Math.cos(i.rotation.y)),f.current.position.set(-13*Math.sin(i.rotation.y),4,-13*Math.cos(i.rotation.y))}),r.a.createElement(r.a.Fragment,null,r.a.createElement("perspectiveCamera",{ref:n,fov:45,aspect:window.innerWidth/window.innerHeight,onUpdate:function(t){return t.updateProjectionMatrix()}}),r.a.createElement("group",{ref:m},r.a.createElement("mesh",{onClick:function(){t.CameraLookNorth(i)},ref:h,geometry:p.geometry},r.a.createElement("meshBasicMaterial",{attach:"material",color:"white"}))),r.a.createElement("group",{onClick:function(){return t.CameraLookNorth(i)},ref:f}))}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement("div",{className:"spinner-container"},r.a.createElement(Y,{width:100,height:100})):r.a.createElement("div",{className:"Pano-canvas"},r.a.createElement(_.a,null,r.a.createElement(this.RenderPano,null)))}},{key:"panoId",get:function(){return this.props.match.params.id||"20190724151553"}}]),n}(a.Component),V=Object(s.g)(J),W=(e(122),[{path:"/maps",title:"Pano Maps"},{path:"/viewPano",title:"View Pano"}]);i.a.render(r.a.createElement(function(){return r.a.createElement(c.a,null,r.a.createElement(h,null,r.a.createElement(m,null,W.map(function(t){return r.a.createElement(c.b,{to:t.path,key:t.path,activeClassName:"ir-nav-item__active",className:"ir-nav-item"},t.title)})),r.a.createElement(g,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/maps",component:T}),r.a.createElement(s.b,{exact:!0,path:"/viewPano/:id",component:V}),r.a.createElement(s.b,{path:"/viewPano",component:V}),r.a.createElement(s.a,{exact:!0,from:"/",to:"maps"})))))},null),document.getElementById("interface"))},27:function(t){t.exports=[{id:"20190724143458",filename:"pano-20190724143458-mx.png",coord:{lat:42.36000896,lng:-71.05425626},calibration:2.1959999999999638},{id:"20190724143833",filename:"pano-20190724143833-mx.png",coord:{lat:42.36000888,lng:-71.05416259},calibration:2.6039999999999637},{id:"20190724145944",filename:"pano-20190724145944-mx.png",coord:{lat:42.36014171,lng:-71.0525956},calibration:-2.368000000000113},{id:"20190724151238",filename:"pano-20190724151238-mx.png",coord:{lat:42.35946,lng:-71.05190878},calibration:-2.872000000000005},{id:"20190724151553",filename:"pano-20190724151553-mx.png",coord:{lat:42.35901057,lng:-71.05173236},calibration:-.5760000000000074},{id:"20190724150711",filename:"pano-20190724150711-mx.png",coord:{lat:42.35976055,lng:-71.05235965},calibration:-1.352814692820381}]},67:function(t,n,e){t.exports=e(123)},71:function(t,n,e){},89:function(t,n,e){}},[[67,1,2]]]);
//# sourceMappingURL=main.3a3d5af1.chunk.js.map