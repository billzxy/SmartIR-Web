(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(t,e,n){t.exports=n.p+"static/media/pano-20190724143458-mx.072de3d6.png"},113:function(t,e,n){t.exports=n.p+"static/media/pano-20190724143833-mx.0732614b.png"},114:function(t,e,n){t.exports=n.p+"static/media/pano-20190724145944-mx.0c7531e1.png"},115:function(t,e,n){t.exports=n.p+"static/media/pano-20190724150711-mx.f67813cf.png"},116:function(t,e,n){t.exports=n.p+"static/media/pano-20190724151238-mx.3f9e7726.png"},117:function(t,e,n){t.exports=n.p+"static/media/pano-20190724151553-mx.c1e8bceb.png"},118:function(t,e,n){t.exports=n.p+"static/media/pano-demo.5890e08b.png"},119:function(t,e,n){t.exports=n.p+"static/media/wall.2b939dad.jpg"},122:function(t,e,n){},123:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(24),i=n.n(o),c=(n(72),n(26)),s=n(17),u=n(15),l=n(16);function d(){var t=Object(u.a)(["\n\tflex: 1;\n\tpadding: 24px;\n\tpadding-top: ","px;\n"]);return d=function(){return t},t}function h(){var t=Object(u.a)(["\n\tposition: fixed;\n\tz-index: 999;\n\ttop: 0;\n\tpadding: ","px;\n\theight: calc(","px - ","px * 2);\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tbackground-color: #f8f8f8;\n\twidth: 100%;\n\n\t& .ir-nav-item {\n\t\tmargin-right: 1rem;\n\t\ttext-decoration: none;\n\t\tcolor: rgba(0, 0, 0, 0.6);\n\t}\n\n\t& .ir-nav-item__active {\n\t\tcolor: #ea6c2f;\n\t}\n"]);return h=function(){return t},t}function f(){var t=Object(u.a)(["\n\twidth: 100vw;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n"]);return f=function(){return t},t}var p=l.a.div(f()),m=l.a.div(h(),12,64,12),g=l.a.div(d(),88),v=n(2),b=n.n(v),y=n(10),w=n(13),x=n(14),k=n(37),j=n(34),M=n(35),O=n(38),P=n(27),E=n(61);function I(t,e,n){if(!n)for(var a=0;a<t.length;a++){var r=[],o=!0,i=!1,c=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value;r.push(t[a][l])}}catch(b){i=!0,c=b}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}return r}for(a=0;a<t.length;a++)if(t[a].id===n){if(0===e.length)return t[a];var d={},h=!0,f=!1,p=void 0;try{for(var m,g=e[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var v=m.value;d[v]=t[a][v]}}catch(b){f=!0,p=b}finally{try{h||null==g.return||g.return()}finally{if(f)throw p}}return d}}function L(t,e){var n=E[e];if(n.length<2)return[];for(var a=0;a<n.length;a++)if(t===n[a])return 0===a?[n[1]]:a===n.length-1?[n[n.length-2]]:[n[a-1],n[a+1]]}var C={getPanoFileNameById:function(t){return Promise.resolve({data:{data:I(P,["filename"],t)}})},getPanoCoordById:function(t){return Promise.resolve({data:{data:I(P,["coord"],t)}})},getAllPanoIdAndCoord:function(){return Promise.resolve({data:{data:P}})},getPanoAllAttrById:function(t){return Promise.resolve({data:{data:I(P,[],t)}})},getNeighborsById:function(t,e){return Promise.resolve({data:{data:L(t,e)}})}};function B(){var t=Object(u.a)(["\n\twidth: 100%;\n\theight: 100%;\n\n\t& > div {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n"]);return B=function(){return t},t}function A(){var t=Object(u.a)(["\n\twidth: 100% !important;\n\theight: 100% !important;\n\tposition: relative !important;\n"]);return A=function(){return t},t}var N=Object(l.a)(O.Map)(A()),z=l.a.div(B()),T=function(t){function e(t){var n;return Object(w.a)(this,e),(n=Object(k.a)(this,Object(j.a)(e).call(this,t))).bounds=new n.props.google.maps.LatLngBounds,n.state={showComp:!1},n}return Object(M.a)(e,t),Object(x.a)(e,[{key:"componentDidMount",value:function(){var t=this;(function(){var e=Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getAllPanoIdAndCoord().then(function(e){for(var n=[],a=e.data.data,r=0;r<a.length;r++)n.push({id:a[r].id,lat:a[r].coord.lat,lng:a[r].coord.lng});t.setState({coords:n,showComp:!0})});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()}},{key:"showComponent",value:function(t){!0!==t&&!1!==t||this.setState({showComp:t})}},{key:"setBounds",value:function(){for(var t=0;t<this.state.coords.length;t++){var e=this.state.coords[t];this.bounds.extend(new this.props.google.maps.LatLng({lat:e.lat,lng:e.lng}))}}},{key:"addMarkers",value:function(){var t=this;return this.setBounds(),this.state.coords.map(function(e,n){return r.a.createElement(O.Marker,{lid:e.id,position:{lat:e.lat,lng:e.lng},onClick:function(e){return t.showComponent(!1),t.gotoPano(e.lid)},key:e.id})})}},{key:"gotoPano",value:function(t){this.props.history.push("/viewPano/".concat(t))}},{key:"render",value:function(){return this.state.showComp?r.a.createElement(N,{ref:this.props.onMapMounted,google:this.props.google,zoom:17,initialCenter:{lat:42.36,lng:-71.053},bounds:this.bounds},this.addMarkers()):null}}]),e}(a.Component),D=Object(O.GoogleApiWrapper)({apiKey:"".concat("AIzaSyAwmnfBgRgSFnydLrrkAJ2gYBfarvA7Fu4")})(Object(s.g)(T)),V=function(t){return r.a.createElement(z,null,r.a.createElement(D,t))},R=n(33),S=n(1),F=n(39),U=(n(90),n(47)),X=function(){function t(e){var n=this;Object(w.a)(this,t),this.coord={lat:0,lng:0},this.calibration=0,this.id=void 0,this.fname="",this.neighborhood="",this.neighborArr=void 0,this.setAllAttr=Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.getPanoAllAttrById(n.id).then(function(t){n.fname=t.data.data.filename,n.coord.lat=t.data.data.coord.lat,n.coord.lng=t.data.data.coord.lng,n.calibration=t.data.data.calibration,n.neighborhood=t.data.data.neighborhood});case 2:case"end":return t.stop()}},t)})),this.getNeighborIds=Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.getNeighborsById(n.id,n.neighborhood).then(function(t){n.neighborArr=t.data.data});case 2:case"end":return t.stop()}},t)})),this.updateCalibration=function(){var t=Object(y.a)(b.a.mark(function t(e){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:({calibration:-e.rotation.y}),alert("Update Calibration is disabled at this moment!");case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),this.id=e}return Object(x.a)(t,[{key:"getDistanceTo",value:function(t){return U.getDistance(this.coord,t.coord)}},{key:"getDistanceToNeighbors",value:function(t){return t.map(this.getDistanceTo)}},{key:"getBearingTo",value:function(t){return U.getRhumbLineBearing(this.coord,t.coord)}},{key:"getBearingToNeighbors",value:function(t){return t.map(this.getBearingTo)}}]),t}(),Y=function(){function t(){Object(w.a)(this,t),this.mesh=void 0,this.material=void 0,this.geometry=void 0,this.id=void 0,this.geometry=new S.ConeBufferGeometry(.2,1,16),this.material=new S.MeshBasicMaterial({color:"white"}),this.mesh=new S.Mesh(this.geometry,this.material)}return Object(x.a)(t,[{key:"onClickHandler",value:function(){}}]),t}();function _(){var t=Object(u.a)(["\n\t&,\n\t&:after {\n\t\tborder-radius: 50%;\n\t\twidth: ","px;\n\t\theight: ","px;\n\t}\n\t& {\n\t\tmargin: 60px auto;\n\t\tfont-size: 10px;\n\t\tposition: relative;\n\t\ttext-indent: -9999em;\n\t\tborder-top: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-right: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-bottom: 1.1em solid rgba(0, 0, 0, 0.1);\n\t\tborder-left: 1.1em solid ",";\n\t\t-webkit-transform: translateZ(0);\n\t\t-ms-transform: translateZ(0);\n\t\ttransform: translateZ(0);\n\t\t-webkit-animation: load8 1.1s infinite linear;\n\t\tanimation: load8 1.1s infinite linear;\n\t}\n\t@-webkit-keyframes load8 {\n\t\t0% {\n\t\t\t-webkit-transform: rotate(0deg);\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\t100% {\n\t\t\t-webkit-transform: rotate(360deg);\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n\t@keyframes load8 {\n\t\t0% {\n\t\t\t-webkit-transform: rotate(0deg);\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\t100% {\n\t\t\t-webkit-transform: rotate(360deg);\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n"]);return _=function(){return t},t}var H=l.a.div(_(),function(t){var e=t.width;return void 0===e?"48":e},function(t){var e=t.width;return void 0===e?"48":e},function(t){var e=t.color;return void 0===e?"#ea6c2f":e}),W=n(111),G=function(t){function e(t){var n;return Object(w.a)(this,e),(n=Object(k.a)(this,Object(j.a)(e).call(this,t))).currLoc=void 0,n.neighbors=void 0,n.cylindergeometry=new S.CylinderBufferGeometry(20,20,15,100,1,!0),n.cylindermaterial=void 0,n.cylindermesh=void 0,n.texture=void 0,n.loader=new S.TextureLoader,n.lines=[],n.state={isLoading:!0},n.RenderPano=n.RenderPano.bind(Object(R.a)(n)),n}return Object(M.a)(e,t),Object(x.a)(e,[{key:"componentDidMount",value:function(){var t=this;(function(){var e=Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.currLoc=new X(t.panoId),e.next=3,t.currLoc.setAllAttr().then(function(){t.loadTexture()});case 3:t.neighbors=new Map,t.setNeighbors();case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()}},{key:"setNeighbors",value:function(){var t=Object(y.a)(b.a.mark(function t(){var e,n,a,r,o,i,c,s=this;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.neighbors.clear(),t.next=3,this.currLoc.getNeighborIds();case 3:if(0!==(e=this.currLoc.neighborArr).length){t.next=9;break}return console.log("No neighbors discorvered..."),t.abrupt("return");case 9:n=!0,a=!1,r=void 0,t.prev=12,o=b.a.mark(function t(){var e,n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.value,n=new X(e),t.next=4,n.setAllAttr().then(function(){s.addNeighbor(n)});case 4:case"end":return t.stop()}},t)}),i=e[Symbol.iterator]();case 15:if(n=(c=i.next()).done){t.next=20;break}return t.delegateYield(o(),"t0",17);case 17:n=!0,t.next=15;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(12),a=!0,r=t.t1;case 26:t.prev=26,t.prev=27,n||null==i.return||i.return();case 29:if(t.prev=29,!a){t.next=32;break}throw r;case 32:return t.finish(29);case 33:return t.finish(26);case 34:case"end":return t.stop()}},t,this,[[12,22,26,34],[27,,29,33]])}));return function(){return t.apply(this,arguments)}}()},{key:"addNeighbor",value:function(t){this.neighbors.set(t.id,{location:t,distance:this.currLoc.getDistanceTo(t),bearing:this.currLoc.getBearingTo(t)})}},{key:"loadTexture",value:function(){var t=this;this.texture=this.loader.load(n(58)("./".concat(this.currLoc.fname)),function(){t.setState({isLoading:!1})},void 0,function(t){console.error(t)}),this.cylindermaterial=new S.MeshBasicMaterial({map:this.texture,side:S.DoubleSide}),this.cylindermesh=new S.Mesh(this.cylindergeometry,this.cylindermaterial),this.cylindergeometry.scale(-1,1,1),this.cylindermesh.rotation.y=this.currLoc.calibration}},{key:"CameraLookNorth",value:function(t){var e={at:t.rotation.y},n=new W.Tween(e).to({at:0},750).easing(W.Easing.Quadratic.InOut);n.onUpdate(function(){t.rotation.y=e.at}),n.onComplete(function(){t.rotation.y=0}),n.start()}},{key:"RenderPano",value:function(){var t=this,e=Object(a.useRef)(),o=Object(F.c)(),i=o.gl,c=o.camera,s=o.canvas,u=o.scene;c.fov=40,i.setSize(s.clientWidth,s.clientHeight),c.position.set(0,0,0),c.lookAt(0,0,0);var l,d,h=new Y,f=Object(a.useRef)(),p=Object(a.useRef)(),m=!1,g=0;var v=0;function w(t){c.rotation.y+=t/1e3,c.rotation.y%=2*Math.PI}s.addEventListener("mousemove",function(t){return function(t){if(m){t.preventDefault();var e=t.clientX-g;t.clientY,g=t.clientX,t.clientY,w(e)}}(t)},!1),s.addEventListener("mousedown",function(t){return(e=t).preventDefault(),m=!0,g=e.clientX,void e.clientY;var e},!1),s.addEventListener("mouseup",function(t){return t.preventDefault(),void(m=!1)},!1),window.addEventListener("mousewheel",function(t){w(t.wheelDeltaY/3)},!1),s.addEventListener("touchmove",function(t){return function(t){var e=t.targetTouches[0].pageX-v;v=t.targetTouches[0].pageX,w(e)}(t)},!1),s.addEventListener("touchstart",function(t){v=t.targetTouches[0].pageX},!1),window.addEventListener("resize",function(){i.setSize(s.clientWidth,s.clientHeight),c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix()},!1);var x=function(e){var n=t.neighbors.get(e).bearing*Math.PI/180,a=-t.neighbors.get(e).bearing*Math.PI/180;c.rotation.y>0&&(a=2*Math.PI-t.neighbors.get(e).bearing*Math.PI/180),c.rotation.y-a>=Math.PI&&c.rotation.y-a<2*Math.PI?a+=2*Math.PI:c.rotation.y-a<=-Math.PI&&c.rotation.y-a<-2*Math.PI&&(a=-2*Math.PI+a);var r={at:c.rotation.y},o={at:a},i=new W.Tween(r).to(o,500).easing(W.Easing.Quadratic.InOut);i.onUpdate(function(){c.rotation.y=r.at}),i.onComplete(function(){c.rotation.y=-t.neighbors.get(e).bearing*Math.PI/180});var s={zVal:c.position.z,xVal:c.position.x,fovValue:c.fov},u={zVal:-15.5*Math.cos(n),xVal:15.5*Math.sin(n),fovValue:75},l=new W.Tween(s).to(u,500);l.onUpdate(function(){c.position.z=s.zVal,c.position.x=s.xVal,c.fov=s.fovValue,c.updateProjectionMatrix()}),l.onComplete(Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.position.z=0,c.position.x=0,c.fov=40,c.updateProjectionMatrix(),t.cylindermaterial.map=t.texture,t.cylindermesh.rotation.y=t.currLoc.calibration,console.log(c.rotation.y),e.next=9,t.setNeighbors().then(j);case 9:case"end":return e.stop()}},e)}))),i.chain(l),i.start()};u.add(this.cylindermesh);var k=function(){var e=Object(y.a)(b.a.mark(function e(a){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.currLoc=t.neighbors.get(a).location,t.texture=t.loader.load(n(58)("./".concat(t.currLoc.fname)),function(){x(a)},void 0,function(t){console.error(t)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=t.neighbors.keys();l=t.neighbors.get(e.next().value);var n=f.current,a=p.current;n.position.z=-Math.cos(l.bearing*Math.PI/180),n.position.x=Math.sin(l.bearing*Math.PI/180),n.rotation.x=-1.5708,n.rotation.z=-l.bearing*Math.PI/180,a.visible=!1,t.neighbors.size>1&&(d=t.neighbors.get(e.next().value),a.visible=!0,a.position.z=-Math.cos(d.bearing*Math.PI/180),a.position.x=Math.sin(d.bearing*Math.PI/180),a.rotation.x=-1.5708,a.rotation.z=-d.bearing*Math.PI/180)};f.current&&p.current&&j();var M=Object(a.useRef)(),O=Object(a.useRef)(),P=Object(a.useRef)(),E=[new S.Vector3(0,1,0),new S.Vector3(-.6,-1,0),new S.Vector3(0,-.5,0),new S.Vector3(.6,-1,0)];function I(t,e){var n=!0,a=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){o.value.material.opacity=e}}catch(c){a=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}}return P.current&&(P.current.vertices=E,P.current.faces.push(new S.Face3(0,1,2)),P.current.faces.push(new S.Face3(0,2,3)),P.current.computeFaceNormals(),P.current.scale(.3,.3,.3)),Object(F.b)(function(){W.update(),M.current.position.set(-13*Math.sin(c.rotation.y),-4,-13*Math.cos(c.rotation.y)),O.current.position.set(-13*Math.sin(c.rotation.y-.4),-3,-13*Math.cos(c.rotation.y-.4)),O.current.rotation.y=c.rotation.y,O.current.rotation.z=-c.rotation.y}),r.a.createElement(r.a.Fragment,null,r.a.createElement("perspectiveCamera",{ref:e,fov:45,aspect:window.innerWidth/window.innerHeight,onUpdate:function(t){return t.updateProjectionMatrix()}}),r.a.createElement("group",{ref:M},r.a.createElement("mesh",{onClick:function(){k(l.location.id)},onPointerOver:function(t){t.object.material.opacity=.9},onPointerOut:function(t){t.object.material.opacity=.5},ref:f,geometry:h.geometry},r.a.createElement("meshBasicMaterial",{attach:"material",color:"light grey",opacity:.5,transparent:!0})),r.a.createElement("mesh",{onClick:function(){k(d.location.id)},onPointerOver:function(t){t.object.material.opacity=.9},onPointerOut:function(t){t.object.material.opacity=.5},ref:p,geometry:h.geometry},r.a.createElement("meshBasicMaterial",{attach:"material",color:"white",opacity:.5,transparent:!0}))),r.a.createElement("group",{onClick:function(){return t.CameraLookNorth(c)},onPointerOver:function(t){I(t.object.children,.8)},onPointerOut:function(t){I(t.object.children,.5)},ref:O},r.a.createElement("mesh",{position:[0,0,0],geometry:new S.CircleGeometry(.4,100,0)},r.a.createElement("meshBasicMaterial",{attach:"material",color:"white",opacity:.5,transparent:!0})),r.a.createElement("mesh",{position:[0,.03,.01]},r.a.createElement("geometry",{attach:"geometry",ref:P}),r.a.createElement("meshBasicMaterial",{attach:"material",color:"red",opacity:.5,transparent:!0}))))}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement("div",{className:"spinner-container"},r.a.createElement(H,{width:100,height:100})):r.a.createElement("div",{className:"Pano-canvas"},r.a.createElement(F.a,null,r.a.createElement(this.RenderPano,null)))}},{key:"panoId",get:function(){return this.props.match.params.id||"20190724151553"}}]),e}(a.Component),q=Object(s.g)(G),J=(n(122),[{path:"/maps",title:"Pano Maps"},{path:"/viewPano",title:"View Pano"}]);i.a.render(r.a.createElement(function(){return r.a.createElement(c.a,null,r.a.createElement(p,null,r.a.createElement(m,null,J.map(function(t){return r.a.createElement(c.b,{to:t.path,key:t.path,activeClassName:"ir-nav-item__active",className:"ir-nav-item"},t.title)})),r.a.createElement(g,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/maps",component:V}),r.a.createElement(s.b,{exact:!0,path:"/viewPano/:id",component:q}),r.a.createElement(s.b,{path:"/viewPano",component:q}),r.a.createElement(s.a,{exact:!0,from:"/",to:"maps"})))))},null),document.getElementById("interface"))},27:function(t){t.exports=[{id:"20190724143458",filename:"pano-20190724143458-mx.png",coord:{lat:42.36000896,lng:-71.05425626},calibration:2.1959999999999638,neighborhood:"quincy"},{id:"20190724143833",filename:"pano-20190724143833-mx.png",coord:{lat:42.36000888,lng:-71.05416259},calibration:2.6039999999999637,neighborhood:"quincy"},{id:"20190724145944",filename:"pano-20190724145944-mx.png",coord:{lat:42.36014171,lng:-71.0525956},calibration:-2.368000000000113,neighborhood:"atlave"},{id:"20190724151238",filename:"pano-20190724151238-mx.png",coord:{lat:42.35946,lng:-71.05190878},calibration:-2.872000000000005,neighborhood:"atlave"},{id:"20190724151553",filename:"pano-20190724151553-mx.png",coord:{lat:42.35901057,lng:-71.05173236},calibration:-.5760000000000074,neighborhood:"atlave"},{id:"20190724150711",filename:"pano-20190724150711-mx.png",coord:{lat:42.35976055,lng:-71.05235965},calibration:-1.352814692820381,neighborhood:"atlave"}]},58:function(t,e,n){var a={"./pano-20190724143458-mx.png":112,"./pano-20190724143833-mx.png":113,"./pano-20190724145944-mx.png":114,"./pano-20190724150711-mx.png":115,"./pano-20190724151238-mx.png":116,"./pano-20190724151553-mx.png":117,"./pano-demo.png":118,"./wall.jpg":119};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=58},61:function(t){t.exports={quincy:["20190724143458","20190724143833"],concord:[],atlave:["20190724151553","20190724151238","20190724150711","20190724145944"]}},68:function(t,e,n){t.exports=n(123)},72:function(t,e,n){},90:function(t,e,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.a0c9c26d.chunk.js.map